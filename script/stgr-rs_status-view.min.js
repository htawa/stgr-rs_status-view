(function(){'use strict';const a=["HP","SP","MP","\u7269\u7406\u653B\u6483\u529B","\u9B54\u6CD5\u653B\u6483\u529B","\u7269\u7406\u9632\u5FA1\u529B","\u9B54\u6CD5\u9632\u5FA1\u529B","\u547D\u4E2D\u529B","\u56DE\u907F\u529B","\u77E5\u529B","\u62B5\u6297\u529B","\u7D20\u65E9\u3055","\u4F1A\u5FC3\u529B","\u4F1A\u5FC3\u5A01\u529B","\u56DE\u5FA9\u529B","\u88AB\u56DE\u5FA9\u529B","HP\u8D85\u904E\u30C0\u30E1\u30FC\u30B8\u8EFD\u6E1B"],b={STR:[4,4,1,9,0,6,1,2,3,1,3,3,2],MAG:[1,1,4,0,9,1,7,3,4,2,1,5,1],AGI:[1,4,0,4,1,2,1,3,6,3,4,7,3],VIT:[8,3,2,1,1,7,5,1,2,2,6,1,0],DEX:[1,3,3,3,3,1,1,7,2,4,3,0,8],MNT:[3,3,8,1,4,1,3,2,1,6,1,2,4]},c={平穏:[0,.04,.04,0,0,0,0,0,0,0,0,0,0,0,0,0,.02],頑丈:[0,0,0,0,0,.035,.035,0,0,0,0,0,0,0,0,0,.03],闘志:[0,0,0,.05,.05,0,0,0,0,0,0,0,0,0,0,0,0],華麗:[0,0,0,0,0,0,0,.05,.05,0,0,0,0,0,0,0,0],慈愛:[.025,0,.025,0,0,0,0,0,0,0,0,0,0,0,.05,0,0],逆境:[0,0,0,0,0,0,0,0,0,0,0,0,.05,.025,0,.025,0],支援:[0,0,0,0,0,0,0,.05,0,.05,0,0,0,0,0,0,0],妨害:[0,0,0,0,0,0,0,0,0,.05,.05,0,0,0,0,0,0],刹那:[0,0,0,0,0,0,0,0,.05,0,0,.05,0,0,0,0,0],守護:[.05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.05,0],余裕:[0,0,0,0,0,0,0,0,.035,0,.035,0,0,0,0,0,.03],増幅:[0,.05,.05,0,0,0,0,0,0,0,0,0,0,0,0,0,0],根性:[0,0,0,0,0,0,0,0,0,0,.05,0,0,0,0,.05,0],精密:[0,0,0,0,0,0,0,.05,0,0,0,0,0,.05,0,0,0],拡散:[0,0,0,0,0,0,0,.05,0,0,0,0,0,0,.05,0,0],庭師:[.025,0,0,.025,.025,0,0,0,0,0,0,0,0,0,.025,0,0]},d=(a=0,b=0,c=0,d=0,e=0,f=0)=>({STR:a,MAG:b,AGI:c,VIT:d,DEX:e,MNT:f}),e=[0,.05,.15,.2,.25,.35,.4,.5,.65],f={};f.getId=function(a){const b=a.split(/(\d+)\s/);return[parseInt(b[1],10),b[2]]},f.getStatus=function(a){const b=a.split(/(STR|MAG|AGI|VIT|DEX|MNT)(\d+)/),c=d();for(let d=0;6>d;d++){const e=3*d+1;c[b[e]]=parseInt(b[e+1],10)}return c},f.getType=function(a){const b=[];for(let c=0;c<a.length;)if("marks marki0"===a[c++].className){const d=a[c++].innerText.split(/【✿(.*)】/);1<d.length&&b.push(d[1])}return b},f.getZukanLv=function(a){return fetch(`http://st.x0.to/?mode=zukan&zeno=${a}`).then(a=>a.text()).then(a=>parseInt(a.split(/開放済みの花図鑑の項目数（花図鑑Lv）\:\s(\d+)/)[1],10))},f.Math={},f.Math.Floor=function(a){for(let b=0;b<a.length;b++)a[b]=Math.floor(a[b]);return a},f.mathState=function(d,f,g){const h=Math.floor(g/50),j=h>=e.length?0:e[h],k=["SP","MP","\u7D20\u65E9\u3055","\u4F1A\u5FC3\u5A01\u529B","HP\u8D85\u904E\u30C0\u30E1\u30FC\u30B8\u8EFD\u6E1B"],l=Object.keys(b).map(c=>{const e=d[c],f=b[c];return f.map(a=>(e+5)*a)}).reduce((a,b)=>{for(let c=0;c<b.length;c++)a[c]+=b[c];return a},[0,0,0,0,0,0,0,0,0,0,0,0,0,100,100,100,100]),m={};l[0]=9*l[0]+500,l[1]=.7*l[1]+50,l[2]=.7*l[2]+50;for(let a=3;a<l.length-4;a++)l[a]*=.2;this.Math.Floor(l);for(let a=0;a<f.length;a++){const b=c[f[a]];for(let a=0;a<l.length;a++)l[a]=Math.ceil(l[a]*(b[a]+1))}for(let b=0;b<l.length;b++)-1===k.findIndex(function(a){return this===a},a[b])&&(l[b]=Math.ceil(l[b]*(j+1)));for(let b=0;b<l.length;b++)m[a[b]]=l[b];return[{ステータス:d,タイプ:f,花図鑑Lv:[g,j]},m]},f.documentGet=function(){const b=this.getId(document.getElementsByClassName("profile")[0].innerText),c=this.getZukanLv(b[0]),d=document.getElementsByClassName("cdatal")[1],a=d.children,e=this.getStatus(a[0].innerText),f=this.getType(a);Promise.all([e,f,c]).then(a=>this.mathState(...a)).then(([b,c])=>{const e=Object.keys(c).map(a=>`<span style="font-size:100%;">${a}：${c[a]}</span>`).join("<br>"),a=document.createElement("div"),d=JSON.stringify(b,null,1);a.classList.add("cdatal"),a.style.float="left",a.style.marginTop="20px",a.innerHTML=`<span class="markp marki2">詳細ステータス</span><br><hr class="dashline"><div style="padding: 5px;">${e}<br>※果実は含まれません。<br>※花図鑑Lv400まで対応。<br><hr class="dashline"><details><summary style="color:#aa4433;cursor:pointer;">取得データ</summary><span style="font-size:80%">${d}</span></details></div>`,document.getElementsByClassName("cdatal")[1].after(a)})},f.checkURL=function(){return!!window.location.href.match(/http:\/\/st\.x0\.to\/\?mode=profile&eno=\d+&detail=\d+/)},f.main=function(){this.checkURL()&&this.documentGet()},f.main()})();